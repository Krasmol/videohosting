# ПЛАН РЕАЛИЗАЦИИ 26 ЗАДАЧ ДЛЯ ZTUBE

## АНАЛИЗ ЗАПРОСА
26 задач: фиксы багов, новые фичи, редизайн, система аутентификации, админка, уведомления, ЛС, автоудаление комнат.

## ЦЕЛЬ
Превратить VideoHost в полноценный ZTUBE с исправленными багами и новым функционалом.

## ТЕКУЩЕЕ СОСТОЯНИЕ
- Flask + SQLAlchemy + Socket.IO + Redis
- 10 моделей БД (User, Channel, Video, Subscription, Room, RoomParticipant, RoomInvitation, ChatMessage, Advertisement, Notification)
- Glassmorphism UI, vanilla JS
- Баги: чат в комнатах (websocket), наложение уведомлений, отсутствие превью, "Пользователь #номер" вместо ника

## ПОШАГОВЫЙ ПЛАН

### ФАЗА 1: Модели и бэкенд (критические изменения БД)
1. **Модель User** — добавить поля: `display_name`, `login_code`, `is_admin`, `is_vip`, `avatar_url`, `bio`, `notifications_enabled`
2. **Модель Room** — добавить поле: `name`, `last_activity`
3. **Модель Video** — добавить поля: `likes_count`, `dislikes_count`, `thumbnail_path`
4. **Новая модель VideoReaction** — лайки/дизлайки
5. **Новая модель VideoReport** — жалобы
6. **Новая модель DirectMessage** — личные сообщения
7. Миграция БД

### ФАЗА 2: Бэкенд API
8. Auth API — валидация логина/пароля (запрет спецсимволов), сложность пароля, генерация пароля, login+code+nickname
9. Admin API — панель администратора
10. Notifications API — получение/запрет уведомлений
11. Subscribers API — просмотр подписчиков
12. Video reactions API — лайки/дизлайки/жалобы
13. Direct messages API — ЛС
14. Room API — удаление лобби, название комнат, автоудаление пустых/неактивных (30 мин)
15. VIP API — подписка за мексель

### ФАЗА 3: WebSocket фиксы
16. Починить чат в комнатах
17. Включение видео для всех (контроль хоста)
18. Никнейм вместо "Пользователь #номер"

### ФАЗА 4: Фронтенд
19. Переименовать VideoHost → ZTUBE
20. Исправить интерфейс + дизайн
21. Исправить наложение уведомлений
22. Формы регистрации/логина — валидация, сложность пароля, генерация
23. Админ-панель UI
24. Ограничение названия/описания видео (50/500)
25. Кнопки лайк/дизлайк/пожаловаться
26. Превью комнат + не отображать превью видео (?)
27. Оформление аккаунта (профиль)
28. ЛС интерфейс
29. Уведомления UI

## АРХИТЕКТУРНЫЕ РЕШЕНИЯ
- login = уникальный логин для входа (без спецсимволов)
- login_code = уникальный код как в Discord (User#1234)
- display_name = отображаемый никнейм
- is_admin = булево поле, при входе под админом показывается кнопка админки
- VIP = is_vip поле + мексель (виртуальная валюта, заглушка)
- Автоудаление комнат = фоновая задача или проверка при запросе

## ОГРАНИЧЕНИЯ
- SQLite (dev), нет реального платежа для VIP
- Автоудаление комнат через проверку при каждом запросе к /api/rooms (без Celery)

## ТЕКУЩИЙ СТАТУС — ФАЗА 2 (ПРОДОЛЖЕНИЕ)

### СДЕЛАНО:
- models.py — полностью
- auth.py, admin.py, notifications.py, messages.py, reactions.py, rooms.py — полностью
- base.html, index.html, video_player.html — полностью
- app.js — полностью
- routes.py, __init__.py — полностью

### ОСТАЛОСЬ:
1. Создать profile.html, messages.html, admin.html
2. Обновить room.html — название комнаты, никнеймы, удаление, контроль хоста
3. Обновить rooms.html — название комнат, ZTUBE, удаление
4. Обновить channel.html — ZTUBE, подписчики
5. Обновить websocket/room_events.py — display_name, last_activity
6. Обновить modern.css — стили уведомлений, колокольчик, панель
7. Убрать все комментарии/docstrings из: subscriptions.py, channels.py, videos.py, services/*
8. Обновить video_service.py — лимит 50/500
9. Пересоздать БД

## КРИТЕРИИ ЗАВЕРШЁННОСТИ
- Все 26 пунктов реализованы
- Приложение запускается без ошибок
- UI обновлён на ZTUBE
